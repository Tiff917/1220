<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Swipe App Container</title>
    <style>
        /* 1. æ­¸é›¶ */
        * { margin: 0; padding: 0; box-sizing: border-box; border: 0; outline: 0; }

        /* 2. èƒŒæ™¯è¨­å®š */
        html, body {
            width: 100%; height: 100%;
            background-color: #F3ECE5; 
            overflow: hidden; /* ç¦æ­¢ Body æ²å‹• */
        }

        /* 3. æ»‘å‹•å®¹å™¨ */
        .app-container {
            display: flex;
            flex-wrap: nowrap;
            width: 100%; /* ä¿®æ­£ç‚º 100% æ¯”è¼ƒç©©å®š */
            height: 100%;
            
            overflow-x: scroll; 
            overflow-y: hidden;
            scroll-snap-type: x mandatory; /* å¼·åˆ¶åˆ†é åœé  */
            
            background-color: #F3ECE5;
            
            /* éš±è—æ²è»¸ */
            scrollbar-width: none; 
            -ms-overflow-style: none;
            -webkit-overflow-scrolling: touch; /* è®“ iOS æ»‘å‹•æ›´é †æš¢ */
        }
        .app-container::-webkit-scrollbar { display: none; }

        /* 4. iframe è¨­å®š */
        iframe {
            display: block;
            /* ä½¿ç”¨ flex å±¬æ€§ä¾†å›ºå®šå¯¬åº¦ï¼Œæ¯” min-width æ›´ç©©å®š */
            flex: 0 0 100%; 
            width: 100%;
            height: 100%;
            
            border: none !important;
            box-shadow: none !important;
            background-color: #F3ECE5;
            
            scroll-snap-align: center; /* æ”¹ç‚º center ç¢ºä¿åœåœ¨æ­£ä¸­é–“ */
            scroll-snap-stop: always;
        }

        /* 5. ä¿®æ­£ iframe é–“éš™ (è¦–éœ€è¦ä¿ç•™) */
        /* å¦‚æœç™¼ç¾æœ‰ç™½ç·šï¼Œå¯ä»¥ä¿ç•™é€™å€‹ margin è¨­å®š */
        /* iframe + iframe { margin-left: -1px; } */

    </style>
</head>
<body>
    
    <div class="app-container" id="appContainer">
        <iframe src="memories.html" frameborder="0"></iframe>
        <iframe src="home.html" id="homeFrame" frameborder="0"></iframe>
        <iframe src="social.html" frameborder="0"></iframe>
    </div>

    <script>
        const container = document.getElementById('appContainer');
        const homeFrame = document.getElementById('homeFrame');

        // 1. åˆå§‹åŒ–å®šä½ (å›åˆ°ä¸­é–“çš„ home.html)
        window.onload = function() {
            // çµ¦ç€è¦½å™¨ä¸€é»æ™‚é–“æ¸²æŸ“ï¼Œç¢ºä¿ offsetLeft æ•¸å€¼æ­£ç¢º
            setTimeout(() => {
                if(container && homeFrame) {
                    // ä½¿ç”¨ scrollTo æ¯”è¼ƒå¹³æ»‘ (ä¹Ÿå¯ä»¥ç”¨ behavior: 'instant' ç¬é–“è·³è½‰)
                    container.scrollTo({
                        left: homeFrame.offsetLeft,
                        behavior: 'auto' 
                    });
                }
            }, 100);
        };

        // 2. â˜… æ™ºæ…§é–å®šé‚è¼¯ â˜…
        setInterval(function() {
            let shouldLock = false; 

            try {
                // æ³¨æ„ï¼šå¦‚æœæ˜¯åœ¨æœ¬æ©Ÿ (file://) åŸ·è¡Œï¼Œé€™ä¸€è¡Œé€šå¸¸æœƒå ±éŒ¯ (Cross-origin)
                // å¿…é ˆè¦åœ¨ Local Server ç’°å¢ƒä¸‹é€™è¡Œæ‰æœ‰æ•ˆ
                if (homeFrame.contentWindow.location.href) {
                    const currentUrl = homeFrame.contentWindow.location.href.toLowerCase();
                    
                    const lockList = [
                        'login.html', 
                        'signup.html', 
                        'forgot-password.html',
                        'profile.html',
                        'payment.html',
                        'otp_verify.html',
                        'reset_password.html',
                        'search.html', 
                        'edit.html', 
                        'message.html',
                        'onboarding.html'
                    ];

                    // æª¢æŸ¥ç›®å‰ç¶²å€
                    if (lockList.some(page => currentUrl.includes(page))) {
                        shouldLock = true;
                    }
                }
            } catch (e) {
                // å¿½ç•¥è·¨åŸŸéŒ¯èª¤ï¼Œé¿å… console è·³å¤ªå¤šç´…å­—
                // console.log("Cross-origin restriction");
            }

            // åŸ·è¡Œé–å®šæˆ–è§£é–
            if (shouldLock) {
                // é–å®šç‹€æ…‹
                if (container.style.overflowX !== 'hidden') {
                    console.log("ğŸ”’ é–å®šæ»‘å‹•ï¼šé€²å…¥ç‰¹å®šé é¢");
                    container.style.overflowX = 'hidden';
                    container.scrollTo({ left: homeFrame.offsetLeft, behavior: 'auto' });
                }
            } else {
                // è§£é–ç‹€æ…‹
                if (container.style.overflowX !== 'scroll') {
                    console.log("ğŸ”“ è§£é–æ»‘å‹•ï¼šå›åˆ°ä¸€èˆ¬é é¢");
                    container.style.overflowX = 'scroll';
                }
            }
        
        }, 100); // <--- åŸæœ¬é€™è£¡å°‘äº†æ‹¬è™Ÿèˆ‡æ™‚é–“è¨­å®š
    </script>
</body>
</html>
